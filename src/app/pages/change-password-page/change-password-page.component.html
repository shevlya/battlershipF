<div class="register-container">
    <div class="register-card">
        <h2>Смена пароля</h2>

        <!-- Сообщения об ошибках -->
        @if(fieldsEmpty) {
            <div class="error-message">
                <div class="error-text">Все поля обязательны для заполнения!</div>
            </div>
        }
        @if(passwordMismatch) {
            <div class="error-message">
                <div class="error-text">Новые пароли не совпадают!</div>
            </div>
        }
        @if(passwordTooShort) {
            <div class="error-message">
                <div class="error-text">Новый пароль должен содержать минимум 6 символов!</div>
            </div>
        }
        @if(sameAsOld) {
            <div class="error-message">
                <div class="error-text">Новый пароль должен отличаться от старого!</div>
            </div>
        }
        @if(oldPasswordIncorrect) {
            <div class="error-message">
                <div class="error-text">Неверный старый пароль!</div>
            </div>
        }
        @if(generalError) {
            <div class="error-message">
                <div class="error-text">{{ generalError }}</div>
            </div>
        }

        <!-- Сообщение об успехе -->
        @if(success) {
            <div class="success-message">
                <div class="success-text">Пароль успешно изменен!</div>
            </div>
        }

        <form (ngSubmit)="changePassword()" (input)="clearErrors()">
            <label for="oldPassword" class="input-label">Введите старый пароль</label>
            <input type="password" id="oldPassword" name="oldPassword"
                   [(ngModel)]="passwordData.oldPassword" 
                   placeholder="Введите старый пароль"
                   required class="input-field"
                   [class.input-field-error]="fieldsEmpty || oldPasswordIncorrect"
                   [disabled]="isLoading">

            <label for="newPassword" class="input-label">Введите новый пароль</label>
            <input type="password" id="newPassword" name="newPassword"
                   [(ngModel)]="passwordData.newPassword" 
                   placeholder="Введите новый пароль"
                   required minlength="6" class="input-field"
                   [class.input-field-error]="fieldsEmpty || passwordTooShort || sameAsOld"
                   [disabled]="isLoading">

            <label for="confirmPassword" class="input-label">Повторите новый пароль</label>
            <input type="password" id="confirmPassword" name="confirmPassword"
                   [(ngModel)]="passwordData.confirmPassword" 
                   placeholder="Повторите новый пароль"
                   required class="input-field"
                   [class.input-field-error]="fieldsEmpty || passwordMismatch"
                   [disabled]="isLoading">

            <button type="submit" class="btn-register" [disabled]="isLoading">
                <span *ngIf="!isLoading">Сменить пароль</span>
                <span *ngIf="isLoading">Изменение...</span>
            </button>
        </form>
        <a routerLink="/profile" class="btn-back">Вернуться в профиль</a>
    </div>
</div>